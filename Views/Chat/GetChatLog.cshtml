@model IEnumerable<ChatManager.Models.Message>

<div>
    @if (ViewBag.Recipient != null)
    {
        <h4>Coversation avec</h4>
        @Helper.AvatarUserIcon(ViewBag.Recipient);
    }
    @if (ViewBag.Recipient == null)
    {
        <h4>Sélectionnez un ami...</h4>
    }
</div>
<hr />
@if (ViewBag.Recipient != null && Model.Count() > 0)
{
    if (Model.Any())
    {
        DateTime datePrecedante = Model.First().DateSent;

        foreach (ChatManager.Models.Message item in Model)
        {
            if ((item.DateSent - datePrecedante).TotalMinutes > 30)
            {
            @Helper.When(item.DateSent);
        };
        string classe;
        if (item.IdRecever == ViewBag.Recipient.Id) { classe = "receiver"; }
        else { classe = "sender"; }

        <div id="?idMessage=@item.Id" class="message @classe userContainer" style="font-size:14px;">
            <p>@item.Text</p>
        </div>
        }
    }
}


